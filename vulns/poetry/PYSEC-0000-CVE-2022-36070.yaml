id: PYSEC-0000-CVE-2022-36070
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
details: Poetry is a dependency manager for Python. To handle dependencies that come
  from a Git repository, Poetry executes various commands, e.g. `git config`. These
  commands are being executed using the executableâ€™s name and not its absolute path.
  This can lead to the execution of untrusted code due to the way Windows resolves
  executable names to paths. Unlike Linux-based operating systems, Windows searches
  for the executable in the current directory first and looks in the paths that are
  defined in the `PATH` environment variable afterward. This vulnerability can lead
  to Arbitrary Code Execution, which would lead to the takeover of the system. If
  a developer is exploited, the attacker could steal credentials or persist their
  access. If the exploit happens on a server, the attackers could use their access
  to attack other internal systems. Since this vulnerability requires a fair amount
  of user interaction, it is not as dangerous as a remotely exploitable one. However,
  it still puts developers at risk when dealing with untrusted files in a way they
  think is safe. The victim could also not protect themself by vetting any Git or
  Poetry config files that might be present in the directory, because the behavior
  is undocumented. Versions 1.1.9 and 1.2.0b1 contain patches for this issue.
affected:
- package:
    name: poetry
    ecosystem: PyPI
    purl: pkg:pypi/poetry
  ranges:
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 1.1.9
references:
- type: ADVISORY
  url: https://github.com/python-poetry/poetry/security/advisories/GHSA-j4j9-7hg9-97g6
- type: WEB
  url: https://github.com/python-poetry/poetry/releases/tag/1.1.9
- type: WEB
  url: https://github.com/python-poetry/poetry/releases/tag/1.2.0b1
aliases:
- CVE-2022-36070
related:
- GHSA-j4j9-7hg9-97g6
- GHSA-j4j9-7hg9-97g6
modified: "2024-11-21T07:12:18Z"
published: "2022-09-07T19:15:08Z"

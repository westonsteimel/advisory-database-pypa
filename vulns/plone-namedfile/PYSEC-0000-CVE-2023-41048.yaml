id: PYSEC-0000-CVE-2023-41048
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
details: plone.namedfile allows users to handle `File` and `Image` fields targeting,
  but not depending on, Plone Dexterity content. Prior to versions 5.6.1, 6.0.3, 6.1.3,
  and 6.2.1, there is a stored cross site scripting vulnerability for SVG images.
  A security hotfix from 2021 already partially fixed this by making sure SVG images
  are always downloaded instead of shown inline. But the same problem still exists
  for scales of SVG images. Note that an image tag with an SVG image as source is
  not vulnerable, even when the SVG image contains malicious code. To exploit the
  vulnerability, an attacker would first need to upload an image, and then trick a
  user into following a specially crafted link. Patches are available in versions
  5.6.1 (for Plone 5.2), 6.0.3 (for Plone 6.0.0-6.0.4), 6.1.3 (for Plone 6.0.5-6.0.6),
  and 6.2.1 (for Plone 6.0.7). There are no known workarounds.
affected:
- package:
    name: plone-namedfile
    ecosystem: PyPI
    purl: pkg:pypi/plone-namedfile
  ranges:
  - type: GIT
    repo: https://github.com/plone/plone.namedfile
    events:
    - introduced: "0"
    - fixed: 188f66a4577021cf8f2bf7c0f5150f9b9573f167
    - fixed: 217d6ce847b7171bf1b73fcb6c08010eb449216a
    - fixed: f0f911f2a72b2e5c923dc2ab9179319cc47788f9
    - fixed: ff5269fb4c79f4eb91dd934561b8824a49a03b60
    - fixed: 188f66a4577021cf8f2bf7c0f5150f9b9573f167
    - fixed: 217d6ce847b7171bf1b73fcb6c08010eb449216a
    - fixed: f0f911f2a72b2e5c923dc2ab9179319cc47788f9
    - fixed: ff5269fb4c79f4eb91dd934561b8824a49a03b60
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 5.6.1
    - introduced: 6.0.0
    - fixed: 6.0.3
    - introduced: 6.1.0
    - fixed: 6.1.3
references:
- type: ADVISORY
  url: https://github.com/plone/plone.namedfile/security/advisories/GHSA-jj7c-jrv4-c65x
- type: ARTICLE
  url: http://www.openwall.com/lists/oss-security/2023/09/22/2
- type: FIX
  url: https://github.com/plone/plone.namedfile/commit/188f66a4577021cf8f2bf7c0f5150f9b9573f167
- type: FIX
  url: https://github.com/plone/plone.namedfile/commit/217d6ce847b7171bf1b73fcb6c08010eb449216a
- type: FIX
  url: https://github.com/plone/plone.namedfile/commit/f0f911f2a72b2e5c923dc2ab9179319cc47788f9
- type: FIX
  url: https://github.com/plone/plone.namedfile/commit/ff5269fb4c79f4eb91dd934561b8824a49a03b60
- type: WEB
  url: http://www.openwall.com/lists/oss-security/2023/09/22/2
- type: WEB
  url: https://github.com/plone/Products.PloneHotfix20210518
aliases:
- CVE-2023-41048
related:
- GHSA-jj7c-jrv4-c65x
- GHSA-jj7c-jrv4-c65x
modified: "2024-11-21T08:20:27Z"
published: "2023-09-21T15:15:10Z"

id: PYSEC-0000-CVE-2024-52581
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
details: Litestar is an Asynchronous Server Gateway Interface (ASGI) framework. Prior
  to version 2.13.0, the multipart form parser shipped with litestar expects the entire
  request body as a single byte string and there is no default limit for the total
  size of the request body. This allows an attacker to upload arbitrary large files
  wrapped in a `multipart/form-data` request and cause excessive memory consumption
  on the server. The multipart form parser in affected versions is vulnerable to this
  type of attack by design. The public method signature as well as its implementation
  both expect the entire request body to be available as a single byte string. It
  is not possible to accept large file uploads in a safe way using this parser. This
  may be a regression, as a variation of this issue was already reported in CVE-2023-25578.
  Limiting the part number is not sufficient to prevent out-of-memory errors on the
  server. A patch is available in version 2.13.0.
affected:
- package:
    name: litestar
    ecosystem: PyPI
    purl: pkg:pypi/litestar
  ranges:
  - type: GIT
    repo: https://github.com/litestar-org/litestar
    events:
    - introduced: "0"
    - fixed: 53c1473b5ff7502816a9a339ffc90731bb0c2138
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 2.13.0
references:
- type: ADVISORY
  url: https://github.com/litestar-org/litestar/security/advisories/GHSA-gjcc-jvgw-wvwj
- type: ADVISORY
  url: https://github.com/litestar-org/litestar/security/advisories/GHSA-p24m-863f-fm6q
- type: EVIDENCE
  url: https://github.com/litestar-org/litestar/security/advisories/GHSA-gjcc-jvgw-wvwj
- type: FIX
  url: https://github.com/litestar-org/litestar/commit/53c1473b5ff7502816a9a339ffc90731bb0c2138
- type: WEB
  url: https://github.com/litestar-org/litestar/blob/main/litestar/_multipart.py#L97
aliases:
- CVE-2024-52581
related:
- GHSA-gjcc-jvgw-wvwj
- GHSA-p24m-863f-fm6q
modified: "2024-11-25T14:15:07Z"
published: "2024-11-20T21:15:08Z"
